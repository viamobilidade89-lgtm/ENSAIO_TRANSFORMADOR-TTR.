<script>
let unidadeResultadoEntrada = 1;
let unidadeResultadoSaida = 1;

function calcValor(v, unidade){
  if(v === "" || isNaN(v)) return null;
  const tm = parseFloat(document.getElementById("tm").value);
  if(isNaN(tm)) return null;
  const Ftemp = (235+75)/(235+tm);
  const leitura = parseFloat(v) * unidade;
  return leitura * 1.5 * Ftemp;
}

function calcular(){
  const ui = parseFloat(document.getElementById("unitIn").value);
  const us = parseFloat(document.getElementById("unitOut").value);

  const entrada = [
    ["H1-H3", calcValor(document.getElementById("e1").value, ui)],
    ["H1-H2", calcValor(document.getElementById("e2").value, ui)],
    ["H2-H3", calcValor(document.getElementById("e3").value, ui)]
  ];

  const saida = [
    ["X0-X1", calcValor(document.getElementById("s1").value, us)],
    ["X0-X2", calcValor(document.getElementById("s2").value, us)],
    ["X0-X3", calcValor(document.getElementById("s3").value, us)]
  ];

  document.getElementById("resEntrada").innerHTML = entrada
    .filter(v=>v[1]!=null)
    .map(v=>`${v[0]}: ${(v[1]/unidadeResultadoEntrada).toExponential(3)}`)
    .join("<br>");

  document.getElementById("resSaida").innerHTML = saida
    .filter(v=>v[1]!=null)
    .map(v=>`${v[0]}: ${(v[1]/unidadeResultadoSaida).toExponential(3)}`)
    .join("<br>");
}

function toggleUnit(tipo){
  if(tipo==="entrada"){
    unidadeResultadoEntrada *= 1000;
  } else {
    unidadeResultadoSaida *= 1000;
  }
  calcular();
}
</script>
