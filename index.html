function calcular(){
    const tm = parseFloat(document.getElementById("tm").value);
    
    if(isNaN(tm)) {
        alert("Por favor, insira a temperatura medida.");
        return;
    }

    // Constantes do Ensaio
    const T = 235;
    const Tr = 75;
    const K = 1.5; // Sua constante de multiplicação
    const Ftemp = (T + Tr) / (T + tm);

    // Unidades (Multiplicadores)
    const ui = parseFloat(document.getElementById("unitIn").value);
    const us = parseFloat(document.getElementById("unitOut").value);

    // Função de cálculo rigorosa
    const processar = (id, multiplicadorUnidade) => {
        const valorRaw = document.getElementById(id).value.replace(',', '.');
        const valor = parseFloat(valorRaw);
        
        if(isNaN(valor)) return null;

        // 1. Converte para Ohms | 2. Aplica Constante | 3. Aplica Fator Temp
        return (valor * multiplicadorUnidade) * K * Ftemp;
    };

    const entradas = [
        { label: "H1-H3", val: processar("e1", ui) },
        { label: "H1-H2", val: processar("e2", ui) },
        { label: "H2-H3", val: processar("e3", ui) }
    ];

    const saidas = [
        { label: "X0-X1", val: processar("s1", us) },
        { label: "X0-X2", val: processar("s2", us) },
        { label: "X0-X3", val: processar("s3", us) }
    ];

    renderizar("resEntrada", entradas, "Ω");
    renderizar("resSaida", saidas, "Ω");
}

function renderizar(containerId, lista, unidade) {
    const container = document.getElementById(containerId);
    const validos = lista.filter(item => item.val !== null);
    
    if(validos.length === 0) {
        container.innerHTML = "Aguardando dados...";
        return;
    }

    container.innerHTML = validos.map(item => {
        // Se o valor for muito pequeno (comum em saída), mostra em mΩ também para conferência
        const valorOhm = item.val.toFixed(6);
        const valorMilli = (item.val * 1000).toFixed(4);
        
        return `<div class="res-item">
                    <strong>${item.label}:</strong> ${valorOhm} Ω 
                    <small>(${valorMilli} mΩ)</small>
                </div>`;
    }).join("");
}
